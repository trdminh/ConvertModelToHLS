#include "Conv.h"
#include "Pool.h"
#include "Dense.h"
#include <algorithm>
#include <string.h>
#include <ap_axi_sdata.h>
typedef ap_fixed<32,16> fxp;
void CNN(fxp InModel[1024],fxp &OutModel0,fxp Weights[274404]){
	fxp OutPadConv0[1156];
	fxp initial_conv[16384];
	fxp initial_bn[16384];
	fxp initial_relu[16384];
	fxp OutPadConv1[18496];
	fxp stage1_block1_conv1[16384];
	fxp stage1_block1_bn1[16384];
	fxp stage1_block1_relu1[16384];
	fxp OutPadConv2[18496];
	fxp stage1_block1_conv2[16384];
	fxp stage1_block1_bn2[16384];
	fxp stage1_block1_add[16384];
	fxp stage1_block1_final_relu[16384];
	fxp OutPadConv3[18496];
	fxp stage1_block2_conv1[16384];
	fxp stage1_block2_bn1[16384];
	fxp stage1_block2_relu1[16384];
	fxp OutPadConv4[18496];
	fxp stage1_block2_conv2[16384];
	fxp stage1_block2_bn2[16384];
	fxp stage1_block2_add[16384];
	fxp stage1_block2_final_relu[16384];
	fxp OutPadConv5[18496];
	fxp stage1_block3_conv1[16384];
	fxp stage1_block3_bn1[16384];
	fxp stage1_block3_relu1[16384];
	fxp OutPadConv6[18496];
	fxp stage1_block3_conv2[16384];
	fxp stage1_block3_bn2[16384];
	fxp stage1_block3_add[16384];
	fxp stage1_block3_final_relu[16384];
	fxp OutPadConv7[17424];
	fxp stage2_block1_conv1[8192];
	fxp stage2_block1_bn1[8192];
	fxp stage2_block1_relu1[8192];
	fxp OutPadConv8[10368];
	fxp stage2_block1_conv2[8192];
	fxp OutPadConv9[15376];
	fxp stage2_block1_shortcut_conv[8192];
	fxp stage2_block1_bn2[8192];
	fxp stage2_block1_shortcut_bn[8192];
	fxp stage2_block1_add[8192];
	fxp stage2_block1_final_relu[8192];
	fxp OutPadConv10[10368];
	fxp stage2_block2_conv1[8192];
	fxp stage2_block2_bn1[8192];
	fxp stage2_block2_relu1[8192];
	fxp OutPadConv11[10368];
	fxp stage2_block2_conv2[8192];
	fxp stage2_block2_bn2[8192];
	fxp stage2_block2_add[8192];
	fxp stage2_block2_final_relu[8192];
	fxp OutPadConv12[10368];
	fxp stage2_block3_conv1[8192];
	fxp stage2_block3_bn1[8192];
	fxp stage2_block3_relu1[8192];
	fxp OutPadConv13[10368];
	fxp stage2_block3_conv2[8192];
	fxp stage2_block3_bn2[8192];
	fxp stage2_block3_add[8192];
	fxp stage2_block3_final_relu[8192];
	fxp OutPadConv14[9248];
	fxp stage3_block1_conv1[4096];
	fxp stage3_block1_bn1[4096];
	fxp stage3_block1_relu1[4096];
	fxp OutPadConv15[6400];
	fxp stage3_block1_conv2[4096];
	fxp OutPadConv16[7200];
	fxp stage3_block1_shortcut_conv[4096];
	fxp stage3_block1_bn2[4096];
	fxp stage3_block1_shortcut_bn[4096];
	fxp stage3_block1_add[4096];
	fxp stage3_block1_final_relu[4096];
	fxp OutPadConv17[6400];
	fxp stage3_block2_conv1[4096];
	fxp stage3_block2_bn1[4096];
	fxp stage3_block2_relu1[4096];
	fxp OutPadConv18[6400];
	fxp stage3_block2_conv2[4096];
	fxp stage3_block2_bn2[4096];
	fxp stage3_block2_add[4096];
	fxp stage3_block2_final_relu[4096];
	fxp OutPadConv19[6400];
	fxp stage3_block3_conv1[4096];
	fxp stage3_block3_bn1[4096];
	fxp stage3_block3_relu1[4096];
	fxp OutPadConv20[6400];
	fxp stage3_block3_conv2[4096];
	fxp stage3_block3_bn2[4096];
	fxp stage3_block3_add[4096];
	fxp stage3_block3_final_relu[4096];
	fxp global_avg_pool[64];
	Padding_Conv2D_0(initial_conv,OutPadConv0);
	Conv2D_0(initial_conv,initial_conv,&Weights[0]);
	BatchNorm2D_0(initial_bn,initial_bn,&Weights[144],&Weights[160],&Weights[176],&Weights[192]);
	Activation0(initial_relu,initial_relu);
	Padding_Conv2D_1(stage1_block1_conv1,OutPadConv1);
	Conv2D_1(stage1_block1_conv1,stage1_block1_conv1,&Weights[208]);
	BatchNorm2D_1(stage1_block1_bn1,stage1_block1_bn1,&Weights[2512],&Weights[2528],&Weights[2544],&Weights[2560]);
	Activation1(stage1_block1_relu1,stage1_block1_relu1);
	Padding_Conv2D_2(stage1_block1_conv2,OutPadConv2);
	Conv2D_2(stage1_block1_conv2,stage1_block1_conv2,&Weights[2576]);
	BatchNorm2D_2(stage1_block1_bn2,stage1_block1_bn2,&Weights[4880],&Weights[4896],&Weights[4912],&Weights[4928]);
	Add_0(stage1_block1_add);
	Activation2(stage1_block1_final_relu,stage1_block1_final_relu);
	Padding_Conv2D_3(stage1_block2_conv1,OutPadConv3);
	Conv2D_3(stage1_block2_conv1,stage1_block2_conv1,&Weights[4944]);
	BatchNorm2D_3(stage1_block2_bn1,stage1_block2_bn1,&Weights[7248],&Weights[7264],&Weights[7280],&Weights[7296]);
	Activation3(stage1_block2_relu1,stage1_block2_relu1);
	Padding_Conv2D_4(stage1_block2_conv2,OutPadConv4);
	Conv2D_4(stage1_block2_conv2,stage1_block2_conv2,&Weights[7312]);
	BatchNorm2D_4(stage1_block2_bn2,stage1_block2_bn2,&Weights[9616],&Weights[9632],&Weights[9648],&Weights[9664]);
	Add_1(stage1_block2_add);
	Activation4(stage1_block2_final_relu,stage1_block2_final_relu);
	Padding_Conv2D_5(stage1_block3_conv1,OutPadConv5);
	Conv2D_5(stage1_block3_conv1,stage1_block3_conv1,&Weights[9680]);
	BatchNorm2D_5(stage1_block3_bn1,stage1_block3_bn1,&Weights[11984],&Weights[12000],&Weights[12016],&Weights[12032]);
	Activation5(stage1_block3_relu1,stage1_block3_relu1);
	Padding_Conv2D_6(stage1_block3_conv2,OutPadConv6);
	Conv2D_6(stage1_block3_conv2,stage1_block3_conv2,&Weights[12048]);
	BatchNorm2D_6(stage1_block3_bn2,stage1_block3_bn2,&Weights[14352],&Weights[14368],&Weights[14384],&Weights[14400]);
	Add_2(stage1_block3_add);
	Activation6(stage1_block3_final_relu,stage1_block3_final_relu);
	Padding_Conv2D_7(stage2_block1_conv1,OutPadConv7);
	Conv2D_7(stage2_block1_conv1,stage2_block1_conv1,&Weights[14416]);
	BatchNorm2D_7(stage2_block1_bn1,stage2_block1_bn1,&Weights[19024],&Weights[19056],&Weights[19088],&Weights[19120]);
	Activation7(stage2_block1_relu1,stage2_block1_relu1);
	Padding_Conv2D_8(stage2_block1_conv2,OutPadConv8);
	Conv2D_8(stage2_block1_conv2,stage2_block1_conv2,&Weights[19152]);
	Padding_Conv2D_9(stage2_block1_shortcut_conv,OutPadConv9);
	Conv2D_9(stage2_block1_shortcut_conv,stage2_block1_shortcut_conv,&Weights[28368]);
	BatchNorm2D_8(stage2_block1_bn2,stage2_block1_bn2,&Weights[28880],&Weights[28912],&Weights[28944],&Weights[28976]);
	BatchNorm2D_9(stage2_block1_shortcut_bn,stage2_block1_shortcut_bn,&Weights[29008],&Weights[29040],&Weights[29072],&Weights[29104]);
	Add_3(stage2_block1_add);
	Activation8(stage2_block1_final_relu,stage2_block1_final_relu);
	Padding_Conv2D_10(stage2_block2_conv1,OutPadConv10);
	Conv2D_10(stage2_block2_conv1,stage2_block2_conv1,&Weights[29136]);
	BatchNorm2D_10(stage2_block2_bn1,stage2_block2_bn1,&Weights[38352],&Weights[38384],&Weights[38416],&Weights[38448]);
	Activation9(stage2_block2_relu1,stage2_block2_relu1);
	Padding_Conv2D_11(stage2_block2_conv2,OutPadConv11);
	Conv2D_11(stage2_block2_conv2,stage2_block2_conv2,&Weights[38480]);
	BatchNorm2D_11(stage2_block2_bn2,stage2_block2_bn2,&Weights[47696],&Weights[47728],&Weights[47760],&Weights[47792]);
	Add_4(stage2_block2_add);
	Activation10(stage2_block2_final_relu,stage2_block2_final_relu);
	Padding_Conv2D_12(stage2_block3_conv1,OutPadConv12);
	Conv2D_12(stage2_block3_conv1,stage2_block3_conv1,&Weights[47824]);
	BatchNorm2D_12(stage2_block3_bn1,stage2_block3_bn1,&Weights[57040],&Weights[57072],&Weights[57104],&Weights[57136]);
	Activation11(stage2_block3_relu1,stage2_block3_relu1);
	Padding_Conv2D_13(stage2_block3_conv2,OutPadConv13);
	Conv2D_13(stage2_block3_conv2,stage2_block3_conv2,&Weights[57168]);
	BatchNorm2D_13(stage2_block3_bn2,stage2_block3_bn2,&Weights[66384],&Weights[66416],&Weights[66448],&Weights[66480]);
	Add_5(stage2_block3_add);
	Activation12(stage2_block3_final_relu,stage2_block3_final_relu);
	Padding_Conv2D_14(stage3_block1_conv1,OutPadConv14);
	Conv2D_14(stage3_block1_conv1,stage3_block1_conv1,&Weights[66512]);
	BatchNorm2D_14(stage3_block1_bn1,stage3_block1_bn1,&Weights[84944],&Weights[85008],&Weights[85072],&Weights[85136]);
	Activation13(stage3_block1_relu1,stage3_block1_relu1);
	Padding_Conv2D_15(stage3_block1_conv2,OutPadConv15);
	Conv2D_15(stage3_block1_conv2,stage3_block1_conv2,&Weights[85200]);
	Padding_Conv2D_16(stage3_block1_shortcut_conv,OutPadConv16);
	Conv2D_16(stage3_block1_shortcut_conv,stage3_block1_shortcut_conv,&Weights[122064]);
	BatchNorm2D_15(stage3_block1_bn2,stage3_block1_bn2,&Weights[124112],&Weights[124176],&Weights[124240],&Weights[124304]);
	BatchNorm2D_16(stage3_block1_shortcut_bn,stage3_block1_shortcut_bn,&Weights[124368],&Weights[124432],&Weights[124496],&Weights[124560]);
	Add_6(stage3_block1_add);
	Activation14(stage3_block1_final_relu,stage3_block1_final_relu);
	Padding_Conv2D_17(stage3_block2_conv1,OutPadConv17);
	Conv2D_17(stage3_block2_conv1,stage3_block2_conv1,&Weights[124624]);
	BatchNorm2D_17(stage3_block2_bn1,stage3_block2_bn1,&Weights[161488],&Weights[161552],&Weights[161616],&Weights[161680]);
	Activation15(stage3_block2_relu1,stage3_block2_relu1);
	Padding_Conv2D_18(stage3_block2_conv2,OutPadConv18);
	Conv2D_18(stage3_block2_conv2,stage3_block2_conv2,&Weights[161744]);
	BatchNorm2D_18(stage3_block2_bn2,stage3_block2_bn2,&Weights[198608],&Weights[198672],&Weights[198736],&Weights[198800]);
	Add_7(stage3_block2_add);
	Activation16(stage3_block2_final_relu,stage3_block2_final_relu);
	Padding_Conv2D_19(stage3_block3_conv1,OutPadConv19);
	Conv2D_19(stage3_block3_conv1,stage3_block3_conv1,&Weights[198864]);
	BatchNorm2D_19(stage3_block3_bn1,stage3_block3_bn1,&Weights[235728],&Weights[235792],&Weights[235856],&Weights[235920]);
	Activation17(stage3_block3_relu1,stage3_block3_relu1);
	Padding_Conv2D_20(stage3_block3_conv2,OutPadConv20);
	Conv2D_20(stage3_block3_conv2,stage3_block3_conv2,&Weights[235984]);
	BatchNorm2D_20(stage3_block3_bn2,stage3_block3_bn2,&Weights[272848],&Weights[272912],&Weights[272976],&Weights[273040]);
	Add_8(stage3_block3_add);
	Activation18(stage3_block3_final_relu,stage3_block3_final_relu);
	GlobalAveragePool2D_0(global_avg_pool,global_avg_pool);
	Dense_0(OutModel0,OutModel0,&Weights[274384],&Weights[273104]);
}
